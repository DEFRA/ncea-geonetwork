steps:

  - task: Maven@4
    inputs:
      mavenPomFile: 'core-geonetwork/pom.xml'
      mavenOptions: '-Xmx3072m'
      javaHomeOption: 'JDKVersion'
      jdkVersionOption: '1.8'
      jdkArchitectureOption: 'x64'
      publishJUnitResults: false
      testResultsFiles: '**/TEST-*.xml'
      goals: 'package -DskipTests -DschemasCopy=true -T 2C'

  - task: CopyFiles@2
    displayName: 'Copy Files to artifact staging directory'
    inputs:
      SourceFolder: '$(System.DefaultWorkingDirectory)'
      Contents: '**/target/*.war'
      TargetFolder: '**/docker/**'

  # - task: CopyFiles@2
  #   displayName: 'Copy Files to artifact staging directory'
  #   inputs:
  #     SourceFolder: '$(System.DefaultWorkingDirectory)'
  #     Contents: '*/docker/*.war'
  #     TargetFolder: $(Build.ArtifactStagingDirectory)

  - task: CmdLine@2
    inputs:
        script: |
          echo "Structure of DefaultWorkingDirectory:"
          tree $(System.DefaultWorkingDirectory)